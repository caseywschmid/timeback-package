{
  "post": {
    "operationId": "createBulkTestAssignments",
    "summary": "Create multiple test assignments",
    "description": "Creates multiple standalone test-out assignments for students. Validates all items and reports all errors before processing. Returns 200 if all succeed, 400 if any validation errors are found. All-or-nothing operation.",
    "tags": ["PowerPath - Test Assignments"],
    "requestBody": {
      "content": {
        "application/json": {
          "schema": {
            "type": "object",
            "properties": {
              "items": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "student": {
                      "type": "string",
                      "description": "The sourcedId of the student"
                    },
                    "subject": {
                      "type": "string",
                      "description": "The subject of the test (e.g., Math)",
                      "enum": [
                        "Reading",
                        "Language",
                        "Vocabulary",
                        "Social Studies",
                        "Writing",
                        "Science",
                        "FastMath",
                        "Math"
                      ]
                    },
                    "grade": {
                      "type": "string",
                      "description": "The grade of the test (e.g., 3)",
                      "enum": [
                        "-1",
                        "0",
                        "1",
                        "2",
                        "3",
                        "4",
                        "5",
                        "6",
                        "7",
                        "8",
                        "9",
                        "10",
                        "11",
                        "12",
                        "13"
                      ]
                    },
                    "testName": {
                      "type": "string",
                      "description": "Optional display name for the test"
                    }
                  },
                  "required": ["student", "subject", "grade"]
                },
                "minItems": 1,
                "description": "Array of test assignments to create"
              }
            },
            "required": ["items"],
            "additionalProperties": false
          }
        }
      }
    },
    "responses": {
      "200": {
        "description": "All assignments created successfully",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean",
                  "description": "Whether all assignments were created successfully"
                },
                "results": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "assignmentId": {
                        "type": "string",
                        "description": "The sourcedId of the test assignment"
                      },
                      "lessonId": {
                        "type": "string",
                        "description": "The sourcedId of the component resource (unlisted lesson)"
                      },
                      "resourceId": {
                        "type": "string",
                        "description": "The sourcedId of the resource created"
                      }
                    },
                    "required": ["assignmentId", "lessonId", "resourceId"]
                  },
                  "description": "Array of successfully created test assignments"
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "row": {
                        "type": "number",
                        "description": "Row number (0-based) where the error occurred"
                      },
                      "message": {
                        "type": "string",
                        "description": "Error message describing what went wrong"
                      }
                    },
                    "required": ["row", "message"]
                  },
                  "description": "Array of errors that occurred during processing"
                }
              },
              "required": ["success", "results", "errors"],
              "additionalProperties": false
            }
          }
        }
      },
      "400": {
        "description": "Validation errors found - no assignments created",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean",
                  "description": "Whether all assignments were created successfully"
                },
                "results": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "assignmentId": {
                        "type": "string",
                        "description": "The sourcedId of the test assignment"
                      },
                      "lessonId": {
                        "type": "string",
                        "description": "The sourcedId of the component resource (unlisted lesson)"
                      },
                      "resourceId": {
                        "type": "string",
                        "description": "The sourcedId of the resource created"
                      }
                    },
                    "required": ["assignmentId", "lessonId", "resourceId"]
                  },
                  "description": "Array of successfully created test assignments"
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "row": {
                        "type": "number",
                        "description": "Row number (0-based) where the error occurred"
                      },
                      "message": {
                        "type": "string",
                        "description": "Error message describing what went wrong"
                      }
                    },
                    "required": ["row", "message"]
                  },
                  "description": "Array of errors that occurred during processing"
                }
              },
              "required": ["success", "results", "errors"],
              "additionalProperties": false
            }
          }
        }
      },
      "401": {
        "description": "Unauthorized",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/UnauthorizedRequestResponse"
            }
          }
        }
      },
      "403": {
        "description": "Forbidden",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ForbiddenResponse"
            }
          }
        }
      },
      "404": {
        "description": "Not Found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/NotFoundResponse"
            }
          }
        }
      },
      "422": {
        "description": "Unprocessable Entity / Validation Error",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/UnprocessableEntityResponse"
            }
          }
        }
      },
      "429": {
        "description": "Too Many Requests",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/TooManyRequestsResponse"
            }
          }
        }
      },
      "500": {
        "description": "Internal Server Error",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/InternalServerErrorResponse"
            }
          }
        }
      }
    }
  }
}
